## 路飞学城

### 概述
#### 背景
- 模式1.0
	- 线下教学，线上售卖录制的视频
- 模式2.0
	- 线下教学，录制视频
	- 通过与51CTO合作，售卖视频，每周一次答疑
- 模式3.0
	- 线下教学，录制视频
	- 与51CTO合作，线上售卖视频，一对一辅导(分阶段，考核，答疑，督促学习)
	- 存在问题：
		- 对导师监管不到位，交互不够，影响课程完成度
- 模式4.0：路飞学城(取代线下班)
	- 录制专门的视频
	- 导师的监管
	- 学生激励
- 本质：在线学习平台，且要提高学生的完成度


#### 系统架构
- 主站
	- rest api
	- vue
- 导师后台
	- django
	- automodel
- 管理后台
	- django
	- automodel

#### 人员和部门
	

#### 需求分析
- 主站
	- 首页
		- 普通页面，html+css+js
	- 课程
		- 普通课程&学位课
			- 普通课程
				- 只卖视频
			- 学位课
				- 分配导师，导师监管学习，推荐就业/保就业......
		- 课程列表&课程详细
			- 课程详细
				- 课程概述
				- 课程阶段
				- 课程评价
				- 常见问题
		- 课程周期定价格
			- 购买学习时长，具有有效期，过期无法学习
	- 支付(最复杂)
		- 支付宝、银联
		- 优惠卷策略
		- 贝里(可抵现金)
		- 购物车
	- 深科技
		- 原创文章
		- 爬虫获取+运营审核
	- 登陆/注册
- 导师后台
- 管理后台

#### 表结构
- 课程相关业务
	- 负责开发的
		- 有大类(CourseCategory)和小类(CourseSubCategory)之分；
		- 课程总体分为两种，学位课(DegreeCourse)和普通课程(Course)；
		- 学位课独有奖学金政策(Scholarship)；
		- 课程都有价格策略(PricePolicy)和优惠卷策略(Coupon)；
		- 课程都有课程详细(CourseDetail)，常见问题(OftenAskedQuestion)，课程大纲(CourseOutline)，课程章节(CourseChapter)，课时目录(CourseSection)；
		- 学位课、普通课程都有讲师，学位课还有导师，使用同一张表(Teacher)；
	- 其他人负责的
		- 学位课
			- 每个模块生成记录(StudyRecord)，买完课程之后自动创建
			- 开通模块(后台)(CourseSchedule)
			- 导师跟进(导师)(StuFollowUpRecord)
			- 交作业(主站)(HomeworkRecord)
- 深科技相关业务
	- 文章来源(ArticleSource)
	- 文章(Article)
	- 收藏(Collection)
	- 评论(Comment)
- 账户相关业务
	- 账户(Account)
	- Token(UserAuthToken)
- 支付业务
	- 

#### 业务详细
1. 学位课，
	1. 学的快，最高返回学费的65%
	2. 作业写得好，最高返回35%
2. 支付业务
	1. 点击加入购物车
		- 增加
			- 使用post请求，创建商品
	2. 购物车页面
		- vue将用户token、课程id和价格策略id传到后台
		- 由认证处理token，通过则继续执行，否则请求登录
		- 将课程id和价格策略id存放到redis，redis买的是阿里云云数据库Redis 版，16G
			- 为什么？
			- 购物车是一个临时的状态，过时会删除
			- 购物车状态会经常变化，避免对数据库造成频繁操作

		- 查看
			- 使用get请求获取redis所有的商品
		- 修改
			- 使用patch请求修改一条商品数据
		- 删除
			- 使用delete请求删除一条商品
	3. 选中课程，点击去结算
		- vue将用户token、课程id发送到后台
		- 认证处理
		- 获取redis中用户购物车的信息，校验vue传送过来的课程ID
		- 获取指定课程信息与用户持有的该课程优惠卷信息，组成字典结构，存放于redis结算中心
	4. 结算页面
		- get方法展示结算页面
		- patch方法，切换选中的优惠卷
	5. 点击立即支付
		- post请求，创建订单
			- 传入是否使用贝里
			- 支付方式以及支付的金额
		- 从redis获取结算中心数据，计算总价
		- 在数据库中生成一个订单
		- 优惠卷被使用
		- 贝里更新


### 项目背景
1. 项目背景
	- 现有在线学习平台都难以保证学习完成度
	- 开创新的在线学习模式
2. 团队
3. 公司名称
4. 项目架构
5. 你负责的什么
6. 遇到的难题/难懂/bug
7. 功能
	- 基于XXX实现XXXX
	- 微信消息推送、短信、邮件，
		- 工厂模式（有哪几种模式）
	- 单例模式
8. 部署
	- jekins:现在部署比较简单，使用jekins的一些脚本就可以快速部署
		- saltstack(rsync/ansible)
		- git
	- nginx
