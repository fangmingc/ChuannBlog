## CRM总结



### CRM描述
1. automodel组件
	- 单例模式（两种方式）
		- 文件导入
		- 定义类
		- 为什么使用单例模式？
			- 当希望程序运行起来时，永远只需要一份
				- 全局变量/全局变量+类
				- 单例模式
		- 何时使用过单例？（都是用全局变量）
			- automodel组件
			- redis链接（crm自动分配订单）
			- 数据库链接+数据库连接池
	- 类
		- FilterRow，可迭代对象
		- FilterOption，用于封装组合搜索的配置
		- ShowList，封装了列表页面所有功能
		- AutomodelConfig，处理用户请求的基类
			- 配置
				- list_display
				- edit_link
				- comb_filter
				- search_field
				- action
				- add_btn
				- model_form
			- 视图函数
			- url处理
		- AutomodelSite，保存对应关系
			- {models.Userinfo: AutomodelConfig(models.Userinfo),...}
	- 可迭代对象
		- 实现\_\_iter__方法
	- inclusion_tag
	- 预留钩子函数，用于权限判断
2. crm
	- 基于automodel为每一个类生成url
		- 反向生成URL
		- 根据类获取app名，类名，字段
	- 增删改查
		- 到底有几张表，每张表是干什么的？
		- 基本CURD
		- 支持扩展
			- PS：遇到的坑？难题？(不能过于简单)
				- popUp+limit_choice_to
				- 开发组件，函数和方法的区别
					- 传参区别，类型区别
	- 推送消息提醒，可实现微信，邮箱提醒
		- 参考django中间件实现
			- rbac.middleware.rbac.RbacClass
			- rsplit
			- importlib
			- getattr




### crm业务流程与逻辑
- 公司内有部门和员工，公司业务对象为客户和学生

- 公司内部管理
	- 部门管理
		- 每个部门有自己的编号
			- 销售部
			- 教质部
			- 市场部
		- 仅限公司高级管理者可见
	- 员工管理
		- 每个员工只归属于某个部门
		- 每个员工入职时需要各种信息录入
			- 邮箱
			- 手机号
			- wechatID
		- 员工主要分为讲师/班主任/销售/助教四种职位
		- 仅限HR部门可见
	- 业务设置
		- 公司下辖多个校区
		- 不同校区可以开设不同课程
		- 每种课程按开班日期分期，即为一个班
			- 每个班只设置一个班主任，可设置多个老师
		- 仅限公司高级管理者可见

- 销售部，负责跟进客户，并将客户发展为学生
	- 新客户
		- 公司(各种渠道批量而来)
			- 手动分配
			- 批量导入
			- 自动分配给销售
				- 权重决定先后
				- 销售量决定分配量
					- 数据：[A,3,9],[B,2,8],[C,2,7]
					- 分配顺序[A,B,C,A,B,C,A...]
			- 消息提醒
				- 邮件
				- 微信
		- 个人
			- 自己录入成为自己客户
			- 满足条件则为公共资源（3天未跟进，15天未成单）
	- 所有客户列表，销售主管可见
		- 查询客户表
	- 公共资源，所有销售可见
		- 定时检查
			- 查询所有满足条件的客户，条件：未报名，3天未跟进或15天未成单
		- 查询客户表（状态未报名，3天未跟进，15天未成单）
		- 抢单（多为新销与暂无客户的老销售使用）
	- '我'的客户，某个销售可见
		- 客户分配表（当前登录销售）
	- 跟进客户
		- 跟进记录
	- 客户成单
		- 客户状态改为已报名
		- 新建学生

- 班级管理
	- 对班主任和讲师展示班级信息，统计总人数
	- 创建班级上课记录
		- 讲师统一初始化该节课学生的学习记录
		- 考勤，更改学习记录的上课记录（请假，已签到，缺勤，迟到，早退）
		- 学生上传作业
		- 助教批改作业
			- 下载作业文件
			- 评分&批语
		- 作业成绩列表



